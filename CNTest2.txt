3)Server

package gen;
import java.io.*;
import java.net.*;
import java.nio.file.*;

public class TCPS {
    public static void main(String[] args) throws Exception {
        ServerSocket ss = new ServerSocket(6000);
        System.out.println("Server Waiting for client...");
        Socket s = ss.accept();
        System.out.println("Client connected!");

        DataInputStream in  = new DataInputStream(s.getInputStream());
        DataOutputStream out = new DataOutputStream(s.getOutputStream());

        String filename = in.readUTF();
        System.out.println("Requested file: " + filename);

        Path path = Paths.get("src/gen", filename);

        if (Files.notExists(path)) {
            out.writeUTF("FILE DOES NOT EXIST ON SERVER");
        } else {
            String data = Files.readString(path);
            out.writeUTF(data.isEmpty() ? "FILE IS EMPTY" : data);
        }

        s.close();
        ss.close();
    }
}

Client

package gen;
import java.io.*;
import java.net.*;
import java.util.*;

public class TCPC {
    public static void main(String[] args) throws Exception {
        Socket s = new Socket("127.0.0.1", 6000);
        System.out.println("Client Connected to Server");

        DataOutputStream out = new DataOutputStream(s.getOutputStream());
        DataInputStream in  = new DataInputStream(s.getInputStream());

        System.out.print("Enter filename: ");
        out.writeUTF(new Scanner(System.in).nextLine());

        System.out.println("\nSERVER RESPONSE â†’ " + in.readUTF());

        s.close();
    }
}

4)Sliding

import java.util.*;

public class SlidingWindowProtocol {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);

        System.out.print("Enter the total number of frames: ");
        int total = sc.nextInt();

        System.out.print("Enter the window size: ");
        int win = sc.nextInt();

        int sent = 0, ack;

        while(sent < total) {
            for(int i=0;i<win && sent<total;i++)
                System.out.println("Frame " + sent++ + " sent.");

            System.out.print("Enter the last acknowledged frame: ");
            ack = sc.nextInt();

            if(ack < sent) sent = ack + 1;
            else System.out.println("Invalid acknowledgment. Try again.");
        }
        System.out.println("All frames sent successfully!");
        sc.close();
    }
}

// Enter the total number of frames: 6 
// Enter the window size: 3
// Frame 0 sent.
// Frame 1 sent.
// Frame 2 sent.
// Enter the last acknowledged frame: 1
// Frame 2 sent.
// Frame 3 sent.
// Frame 4 sent.
// Enter the last acknowledged frame: 2
// Frame 3 sent.
// Frame 4 sent.
// Frame 5 sent.
// Enter the last acknowledged frame: 5
// All frames sent successfully!


1) Simulation
1.tcl
# Create Simulator
set ns [new Simulator]

# Trace file and NAM file
set nt [open 1.tr w]
$ns trace-all $nt

set nm [open 1.nam w]
$ns namtrace-all $nm

# Create 3 nodes
set n0 [$ns node]
set n1 [$ns node]
set n2 [$ns node]

# Create duplex links
$ns duplex-link $n0 $n1 100Mb 10ms DropTail
$ns duplex-link $n1 $n2 100Mb 5ms DropTail  #Change mb and vary the packets dropped

# Set queue limit
$ns queue-limit $n0 $n1 10   #Change value and vary the packets dropped

# Create UDP + Null Agents
set u [new Agent/UDP]
$ns attach-agent $n0 $u

set n [new Agent/Null]
$ns attach-agent $n2 $n

# Attach CBR application
set cb [new Application/Traffic/CBR]
$cb attach-agent $u
$cb set packetSize_ 5000
$cb set interval_ 0.001

# Connect source to destination
$ns connect $u $n

# Finish procedure
proc finish {} {
    global ns nt nm
    $ns flush-trace
    close $nt
    close $nm
    exec nam 1.nam &
    exit 0
}

# Scheduling
$ns at 0.1 "$cb start"
$ns at 1.8 "$cb stop"
$ns at 2.0 "finish"

# Run Simulation
$ns run

1.awk
BEGIN {
    drop = 0;
}

{
    if($1=="d")
        drop++;
}

END {
    printf("The no of packets dropped is= %d\n", drop);
}

Terminal
gedit 1.tcl       # to edit TCL file
ns 1.tcl          # run simulation & generate trace file
gedit 1.awk       # create awk script
awk -f 1.awk 1.tr # execute awk on trace to count drops


2)Simulation
2.tcl
# Create Simulator
set ns [new Simulator]

# Create trace & nam files
set nf [open 2.nam w]
$ns namtrace-all $nf

set tf [open 2.tr w]
$ns trace-all $tf

# Create 6 nodes
set n0 [$ns node]
set n1 [$ns node]
set n2 [$ns node]
set n3 [$ns node]
set n4 [$ns node]
set n5 [$ns node]

# Create duplex connections
$ns duplex-link $n0 $n4 50Mb 1ms DropTail   #Change mb
$ns duplex-link $n1 $n4 50Mb 1ms DropTail
$ns duplex-link $n2 $n4 50Mb 1ms DropTail   #Change mb
$ns duplex-link $n3 $n4 50Mb 1ms DropTail
$ns duplex-link $n4 $n5 50Mb 5ms DropTail   #Change mb(bandwidth)

# ===================== PING AGENTS =========================

# Ping 1
set p0 [new Agent/Ping]
$ns attach-agent $n0 $p0
$p0 set packetSize_ 5000    
$p0 set interval_ 0.00001

# Ping 2
set p2 [new Agent/Ping]
$ns attach-agent $n2 $p2
$p2 set packetSize_ 5000     #change packetsize
$p2 set interval_ 0.00001

# Ping destination
set p1 [new Agent/Ping]
$ns attach-agent $n1 $p1

set p3 [new Agent/Ping]
$ns attach-agent $n3 $p3

set p5 [new Agent/Ping]
$ns attach-agent $n5 $p5

# ============================================================

# Queue limits to create congestion
$ns queue-limit $n0 $n4 5
$ns queue-limit $n1 $n4 5
$ns queue-limit $n2 $n4 5

# Ping callback (prints RTT)
Agent/Ping instproc recv {from rtt} {
        $self instvar node_
        puts "Node [$node_ id] received answer from $from with round trip time $rtt msec"
}

# Connections
$ns connect $p0 $p5
$ns connect $p2 $p3

# ======================  Scheduler ===========================
# Ping-packets sent multiple times
$ns at 0.1 "$p0 send"
$ns at 0.2 "$p0 send"
$ns at 0.3 "$p0 send"
$ns at 0.4 "$p0 send"
$ns at 0.5 "$p0 send"
$ns at 0.6 "$p0 send"
$ns at 0.7 "$p0 send"
$ns at 0.8 "$p0 send"
$ns at 0.9 "$p0 send"
$ns at 1.0 "$p0 send"

#
$ns at 1.1 "$p0 send"  Changes to vary packets
$ns at 1.2 "$p0 send" 
$ns at 1.3 "$p0 send"
$ns at 1.4 "$p0 send"  Till here
#

$ns at 0.1 "$p2 send"
$ns at 0.2 "$p2 send"
$ns at 0.3 "$p2 send"
$ns at 0.4 "$p2 send"
$ns at 0.5 "$p2 send"
$ns at 0.6 "$p2 send"
$ns at 0.7 "$p2 send"
$ns at 0.8 "$p2 send"
$ns at 0.9 "$p2 send"
$ns at 1.0 "$p2 send"

#
$ns at 1.1 "$p2 send"  Changes to vary packets
$ns at 1.2 "$p2 send" 
$ns at 1.3 "$p2 send"
$ns at 1.4 "$p2 send"  Till here
#

# Finish Procedure
proc finish {} {
    global ns tf nf
    $ns flush-trace
    close $nf
    close $tf
    exec nam 2.nam &
    exit 0
}

$ns at 2.0 "finish"
$ns run

2.awk
BEGIN {
    drop = 0;
}

{
    if($1=="d")
        drop++;
}

END {
    printf("Total number of %s packets dropped due to congestion =%d\n",$5,drop);
}

terminal
gedit 2.tcl           # write the code
ns 2.tcl              # run and generate output
nam 2.nam             # view animation
gedit 2.awk           # paste AWK script
awk -f 2.awk 2.tr     # get no. of dropped packets


